{
  "privateEndpoints": {
    "admin-backend": {
      "url": "http://localhost:3000"
    },
    "manager-backend": {
      "url": "http://localhost:4000"
    }
  },
  "pipelines": [
    {
      "name": "manager-pipeline",
      "policies":[
        {
          "condition": ["always"],
          "action": "proxy",
          "params": {
            "privateEndpoint": "manager-backend"
          }
        }
      ]
    },
    {
      "name": "admin-pipeline",
      "policies":[
        {
          "condition": ["always"],
          "action": "proxy",
          "params": {
            "privateEndpoint": "admin-backend"
          }
        }
      ]
    },
    {
      "name": "example-pipeline",
      "policies": [
        {
          "condition": ["always"],
          "action": "log",
          "params": {
            "message": "${req.method} ${req.originalUrl}"
          }
        },
        {
          "condition": ["always"],
          "action": "oauth2",
          "params": {
            "issuer": "https://www.lunchbadger.com",
            "audience": "4kzhU5LqlUpQJmjbMevWkWyt9adeKK",
            "algorithms": ["RS256"],
            "key": "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvfjNBl0+VTV3Bg9Yk5vb\n2U4jrnQ7E8zOerwmMJHd4T432CpUqdLIhCupbz3wjvnW4K3zSc23wB/DHjhvpPEj\nH40kFfeIBKetv0/aoC8yEpkMDoRHNxsj+PfAHGnZwuCIU9S9CpcDdfHlWzM8YlKx\nbhLymO3mMkWlwApa3ryAw/3WAZqxcvdRQGfh+9bDym5OOkjg9ygAtf1oBTrEeK88\nwjsm7LUBxQ/CYzUHEmuTK66UxLZZYt8xY6wJ9OE+ZQauPlgfS2c+kA2NZMFqVVSe\nEkNj7jjkVlLgL4bqAxYk60RxkWe/ROKyiTdZkEsQz0MCmtkxTdmWRfbn7CM6MuJm\nQwIDAQAB\n-----END PUBLIC KEY-----"
          }
        },
        {
          "condition": ["inRole", "manager"],
          "action": "runPipeline",
          "params": {
            "pipeline": "manager-pipeline"
          }
        },
        {
          "condition": ["inRole", "admin"],
          "action": "runPipeline",
          "params": {
            "pipeline": "admin-pipeline"
          }
        }
      ]
    }
  ]
}
